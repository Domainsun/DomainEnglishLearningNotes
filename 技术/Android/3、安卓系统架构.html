<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Domainsun的英语自学笔记</title>
    <meta name="generator" content="VuePress 1.9.10">
    
    <meta name="description" content="英语学习手册,语法,英语学习方法,英语工具资源,背单词方法">
    
    <link rel="preload" href="/assets/css/0.styles.0cf1db6b.css" as="style"><link rel="preload" href="/assets/js/app.75a2606c.js" as="script"><link rel="preload" href="/assets/js/3.7b5fc60a.js" as="script"><link rel="preload" href="/assets/js/1.84786563.js" as="script"><link rel="preload" href="/assets/js/68.fbf4d68c.js" as="script"><link rel="prefetch" href="/assets/js/10.f59203a1.js"><link rel="prefetch" href="/assets/js/100.010d14e1.js"><link rel="prefetch" href="/assets/js/101.8278cbc2.js"><link rel="prefetch" href="/assets/js/102.331de778.js"><link rel="prefetch" href="/assets/js/103.6ad07d2a.js"><link rel="prefetch" href="/assets/js/104.ccde0b66.js"><link rel="prefetch" href="/assets/js/105.b965572a.js"><link rel="prefetch" href="/assets/js/106.77edbdf3.js"><link rel="prefetch" href="/assets/js/107.3027eb1a.js"><link rel="prefetch" href="/assets/js/108.17396dbc.js"><link rel="prefetch" href="/assets/js/109.7eae1616.js"><link rel="prefetch" href="/assets/js/11.3ea8a968.js"><link rel="prefetch" href="/assets/js/110.889c70dd.js"><link rel="prefetch" href="/assets/js/111.5f5759e6.js"><link rel="prefetch" href="/assets/js/112.46632438.js"><link rel="prefetch" href="/assets/js/113.e52a8dff.js"><link rel="prefetch" href="/assets/js/114.4cf8ce8b.js"><link rel="prefetch" href="/assets/js/115.ee1fde1b.js"><link rel="prefetch" href="/assets/js/116.c5b5c50d.js"><link rel="prefetch" href="/assets/js/117.0165856e.js"><link rel="prefetch" href="/assets/js/118.25c54d46.js"><link rel="prefetch" href="/assets/js/119.f4c39a82.js"><link rel="prefetch" href="/assets/js/12.778a3f26.js"><link rel="prefetch" href="/assets/js/120.df02ecf3.js"><link rel="prefetch" href="/assets/js/121.bf7dda66.js"><link rel="prefetch" href="/assets/js/122.b6f17cbf.js"><link rel="prefetch" href="/assets/js/123.553009f5.js"><link rel="prefetch" href="/assets/js/124.78dd2967.js"><link rel="prefetch" href="/assets/js/125.b956d8f9.js"><link rel="prefetch" href="/assets/js/126.60958c96.js"><link rel="prefetch" href="/assets/js/127.cf7b03ea.js"><link rel="prefetch" href="/assets/js/128.fd32762b.js"><link rel="prefetch" href="/assets/js/129.4be5e017.js"><link rel="prefetch" href="/assets/js/130.af921229.js"><link rel="prefetch" href="/assets/js/131.d32a3073.js"><link rel="prefetch" href="/assets/js/132.9c6555c3.js"><link rel="prefetch" href="/assets/js/133.f365cd5b.js"><link rel="prefetch" href="/assets/js/134.7fa44463.js"><link rel="prefetch" href="/assets/js/135.5b24b8d3.js"><link rel="prefetch" href="/assets/js/136.cfb85c3b.js"><link rel="prefetch" href="/assets/js/137.72bc5461.js"><link rel="prefetch" href="/assets/js/138.b57eb0b6.js"><link rel="prefetch" href="/assets/js/139.a131b135.js"><link rel="prefetch" href="/assets/js/140.fcba23ba.js"><link rel="prefetch" href="/assets/js/141.4c7c54f2.js"><link rel="prefetch" href="/assets/js/142.d262cae7.js"><link rel="prefetch" href="/assets/js/143.c8a89b4f.js"><link rel="prefetch" href="/assets/js/144.bfd9e69e.js"><link rel="prefetch" href="/assets/js/145.8d649578.js"><link rel="prefetch" href="/assets/js/146.f45e0061.js"><link rel="prefetch" href="/assets/js/147.4e7518db.js"><link rel="prefetch" href="/assets/js/15.cda47e54.js"><link rel="prefetch" href="/assets/js/16.fb57443f.js"><link rel="prefetch" href="/assets/js/17.c9efba56.js"><link rel="prefetch" href="/assets/js/18.e1216b3c.js"><link rel="prefetch" href="/assets/js/19.14a882c9.js"><link rel="prefetch" href="/assets/js/2.8f91be42.js"><link rel="prefetch" href="/assets/js/20.019fe389.js"><link rel="prefetch" href="/assets/js/21.f28e4a2e.js"><link rel="prefetch" href="/assets/js/22.faa48535.js"><link rel="prefetch" href="/assets/js/23.363c05b4.js"><link rel="prefetch" href="/assets/js/24.a81f0683.js"><link rel="prefetch" href="/assets/js/25.e1793479.js"><link rel="prefetch" href="/assets/js/26.14af8cf8.js"><link rel="prefetch" href="/assets/js/27.1a97081c.js"><link rel="prefetch" href="/assets/js/28.d4929efd.js"><link rel="prefetch" href="/assets/js/29.300d28f7.js"><link rel="prefetch" href="/assets/js/30.6572996b.js"><link rel="prefetch" href="/assets/js/31.d7b50c38.js"><link rel="prefetch" href="/assets/js/32.f827013d.js"><link rel="prefetch" href="/assets/js/33.11143a07.js"><link rel="prefetch" href="/assets/js/34.9c9d7d30.js"><link rel="prefetch" href="/assets/js/35.4ba4fe5f.js"><link rel="prefetch" href="/assets/js/36.bb76d201.js"><link rel="prefetch" href="/assets/js/37.8d894fd0.js"><link rel="prefetch" href="/assets/js/38.eab8f7b1.js"><link rel="prefetch" href="/assets/js/39.a14804b8.js"><link rel="prefetch" href="/assets/js/4.f87653e8.js"><link rel="prefetch" href="/assets/js/40.5da7dcfd.js"><link rel="prefetch" href="/assets/js/41.8ef5d93d.js"><link rel="prefetch" href="/assets/js/42.6fb79061.js"><link rel="prefetch" href="/assets/js/43.82a5af19.js"><link rel="prefetch" href="/assets/js/44.59aed4d3.js"><link rel="prefetch" href="/assets/js/45.f50d48e1.js"><link rel="prefetch" href="/assets/js/46.93a8cfb2.js"><link rel="prefetch" href="/assets/js/47.3c251ced.js"><link rel="prefetch" href="/assets/js/48.38b10cbe.js"><link rel="prefetch" href="/assets/js/49.a073a187.js"><link rel="prefetch" href="/assets/js/5.4ffa01f2.js"><link rel="prefetch" href="/assets/js/50.1f89d19c.js"><link rel="prefetch" href="/assets/js/51.0378ab98.js"><link rel="prefetch" href="/assets/js/52.e3720aef.js"><link rel="prefetch" href="/assets/js/53.36161899.js"><link rel="prefetch" href="/assets/js/54.721004f5.js"><link rel="prefetch" href="/assets/js/55.d307aecb.js"><link rel="prefetch" href="/assets/js/56.d54c9c15.js"><link rel="prefetch" href="/assets/js/57.b6b7c537.js"><link rel="prefetch" href="/assets/js/58.869601b8.js"><link rel="prefetch" href="/assets/js/59.508824bf.js"><link rel="prefetch" href="/assets/js/6.c55d2fe6.js"><link rel="prefetch" href="/assets/js/60.70580ecb.js"><link rel="prefetch" href="/assets/js/61.008c3a06.js"><link rel="prefetch" href="/assets/js/62.06c5d100.js"><link rel="prefetch" href="/assets/js/63.e9bf2425.js"><link rel="prefetch" href="/assets/js/64.bcfa5861.js"><link rel="prefetch" href="/assets/js/65.0035a0c3.js"><link rel="prefetch" href="/assets/js/66.36d619f7.js"><link rel="prefetch" href="/assets/js/67.8dc67b33.js"><link rel="prefetch" href="/assets/js/69.141e8266.js"><link rel="prefetch" href="/assets/js/7.647429c8.js"><link rel="prefetch" href="/assets/js/70.9780fe09.js"><link rel="prefetch" href="/assets/js/71.404ad4d3.js"><link rel="prefetch" href="/assets/js/72.d583bcc1.js"><link rel="prefetch" href="/assets/js/73.8852d25b.js"><link rel="prefetch" href="/assets/js/74.5cbcad7b.js"><link rel="prefetch" href="/assets/js/75.b8b8570e.js"><link rel="prefetch" href="/assets/js/76.92df56e2.js"><link rel="prefetch" href="/assets/js/77.9cb135eb.js"><link rel="prefetch" href="/assets/js/78.d1317e33.js"><link rel="prefetch" href="/assets/js/79.81147cba.js"><link rel="prefetch" href="/assets/js/8.19d34e47.js"><link rel="prefetch" href="/assets/js/80.c430ba95.js"><link rel="prefetch" href="/assets/js/81.65a9abb9.js"><link rel="prefetch" href="/assets/js/82.50f6663a.js"><link rel="prefetch" href="/assets/js/83.d4ce0001.js"><link rel="prefetch" href="/assets/js/84.8c5964db.js"><link rel="prefetch" href="/assets/js/85.1e6f2c17.js"><link rel="prefetch" href="/assets/js/86.f72fb8cf.js"><link rel="prefetch" href="/assets/js/87.572422a3.js"><link rel="prefetch" href="/assets/js/88.1c40aa4f.js"><link rel="prefetch" href="/assets/js/89.eaa1e3a6.js"><link rel="prefetch" href="/assets/js/9.2a47aba7.js"><link rel="prefetch" href="/assets/js/90.a210f38b.js"><link rel="prefetch" href="/assets/js/91.976bc16f.js"><link rel="prefetch" href="/assets/js/92.826a2480.js"><link rel="prefetch" href="/assets/js/93.d5b0bf54.js"><link rel="prefetch" href="/assets/js/94.182d5842.js"><link rel="prefetch" href="/assets/js/95.cee6c154.js"><link rel="prefetch" href="/assets/js/96.e00cc6aa.js"><link rel="prefetch" href="/assets/js/97.d4cfb682.js"><link rel="prefetch" href="/assets/js/98.569e77cb.js"><link rel="prefetch" href="/assets/js/99.5e2fd19b.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.3c664a3a.js">
    <link rel="stylesheet" href="/assets/css/0.styles.0cf1db6b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Domainsun的英语自学笔记</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/英语/" class="nav-link">
  英语
</a></div><div class="nav-item"><a href="/技术/" class="nav-link">
  技术
</a></div><div class="nav-item"><a href="/工具资源/" class="nav-link">
  工具资源
</a></div><div class="nav-item"><a href="/个人生活/" class="nav-link">
  个人生活
</a></div><div class="nav-item"><a href="/" class="nav-link">
  关于
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/英语/" class="nav-link">
  英语
</a></div><div class="nav-item"><a href="/技术/" class="nav-link">
  技术
</a></div><div class="nav-item"><a href="/工具资源/" class="nav-link">
  工具资源
</a></div><div class="nav-item"><a href="/个人生活/" class="nav-link">
  个人生活
</a></div><div class="nav-item"><a href="/" class="nav-link">
  关于
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span></span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/%E6%8A%80%E6%9C%AF/Android/3%E3%80%81%E5%AE%89%E5%8D%93%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84.html#mvc" class="sidebar-link">MVC</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/%E6%8A%80%E6%9C%AF/Android/3%E3%80%81%E5%AE%89%E5%8D%93%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84.html#实现代码说明" class="sidebar-link">实现代码说明</a></li><li class="sidebar-sub-header"><a href="/%E6%8A%80%E6%9C%AF/Android/3%E3%80%81%E5%AE%89%E5%8D%93%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84.html#优缺点" class="sidebar-link">优缺点</a></li></ul></li><li><a href="/%E6%8A%80%E6%9C%AF/Android/3%E3%80%81%E5%AE%89%E5%8D%93%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84.html#mvp" class="sidebar-link">MVP</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/%E6%8A%80%E6%9C%AF/Android/3%E3%80%81%E5%AE%89%E5%8D%93%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84.html#实现代码说明-2" class="sidebar-link">实现代码说明</a></li><li class="sidebar-sub-header"><a href="/%E6%8A%80%E6%9C%AF/Android/3%E3%80%81%E5%AE%89%E5%8D%93%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84.html#优缺点-2" class="sidebar-link">优缺点</a></li></ul></li><li><a href="/%E6%8A%80%E6%9C%AF/Android/3%E3%80%81%E5%AE%89%E5%8D%93%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84.html#mvvm" class="sidebar-link">MVVM</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/%E6%8A%80%E6%9C%AF/Android/3%E3%80%81%E5%AE%89%E5%8D%93%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84.html#实现代码说明-3" class="sidebar-link">实现代码说明</a></li><li class="sidebar-sub-header"><a href="/%E6%8A%80%E6%9C%AF/Android/3%E3%80%81%E5%AE%89%E5%8D%93%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84.html#优缺点-3" class="sidebar-link">优缺点</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p>一篇文章讲清楚Android中的MVC、MVP、MVVM架构 （附实现代码）</p> <h1 id="_01-架构介绍"><a href="#_01-架构介绍" class="header-anchor">#</a> 01 架构介绍</h1> <p>先来看一下MVC、MVP、MVVM的架构图。</p> <p><img src="https://gitee.com/yutian_9065/img/raw/master/img/202302061457193.png" alt="image-20230206145755111"></p> <p>从这些架构图中，可以看到每种架构都有3个模块以及数据流动方向箭头。</p> <p><strong>模块</strong></p> <p>在系统架构中，首先要做的就是把系统整体按照一定的原则划分成模块。</p> <p><strong>数据流动</strong></p> <p>模块划分之后，模块之间的通信，就是数据的流动。在Android中，流动数据包括两部分，事件和数据。</p> <p><strong>架构</strong></p> <p>模块和模块之间的数据通信方式构成不同的架构。在这3种架构中，都是把系统整体划分成了3个模块：<strong>视图层，数据层，业务层。</strong> 他们之间的区别在于，模块之间的通信方式（数据流动方向）不一致。</p> <ul><li>MVC是视图层接收到事件后调用到业务层处理业务逻辑，业务层调用数据层处理数据，数据层再调用视图层更新页面。</li> <li>MVP是视图层接收到事件后调用到业务层处理，业务层调用数据层处理数据，数据层处理数据后回调给业务层，业务层再回调给视图层更新页面。（数据层已不再持有视图层，他们之间通过业务层（Presenter）交互，具体使用接口实现，使数据层和视图层解耦。</li> <li>MVVM在MVP的基础上实现了视图层和业务层的双向数据绑定（data binding），不再通过接口的方式交互，ViewModel不在和Presenter一样持有视图层，使视图层和业务层解耦。</li></ul> <h1 id="_02-具体实现"><a href="#_02-具体实现" class="header-anchor">#</a> 02 具体实现</h1> <h2 id="mvc"><a href="#mvc" class="header-anchor">#</a> MVC</h2> <p><img src="https://gitee.com/yutian_9065/img/raw/master/img/202302061505418.png" alt="image-20230206150541382"></p> <p>视图层：在MVC架构中， Android的xml布局文件和Activity/Fragment文件被划分为View视图层。 因为xml作为视图层功能太弱，只能够实现页面的布局，不能够实现页面数据和事件的处理。需要和Activity一起才能够构成一个完整的视图层。</p> <p>业务层：大多数的MVC架构开发的安卓项目， 并没有把Controller业务层独立出来，而是将业务层也在Activity/Fragment中实现。这导致了Activity/Fragment的代码非常臃肿，这就是MVC的缺点之一。 在本例中，我们会将业务层独立出来，实现一个标准的MVC架构。</p> <p>数据层：数据层Model指的是，数据管理模块，这包括了数据的获取，处理。存储等。 MVP、MVVM的架构中的Model也是一样。后面不再赘述。</p> <p><strong>代码结构</strong></p> <p><img src="https://gitee.com/yutian_9065/img/raw/master/img/202302061526151.png" alt="image-20230206152617106"></p> <p><strong>xml代码</strong></p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>LinearLayout</span> <span class="token attr-name"><span class="token namespace">xmlns:</span>android</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://schemas.android.com/apk/res/android<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name"><span class="token namespace">xmlns:</span>android</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://schemas.android.com/apk/res/android<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name"><span class="token namespace">android:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@+id/ll_gallery_outer<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>match_parent<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>match_parent<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name"><span class="token namespace">android:</span>orientation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>vertical<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>TextView</span>
        <span class="token attr-name"><span class="token namespace">android:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@+id/tv_result<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>wrap_content<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>wrap_content<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name"><span class="token namespace">android:</span>layout_gravity</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>center<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>EditText</span>
        <span class="token attr-name"><span class="token namespace">android:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@+id/tv_account<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>match_parent<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>40dp<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name"><span class="token namespace">android:</span>layout_gravity</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>center<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name"><span class="token namespace">android:</span>layout_marginLeft</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>16dp<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name"><span class="token namespace">android:</span>layout_marginTop</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>20dp<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name"><span class="token namespace">android:</span>layout_marginRight</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>16dp<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name"><span class="token namespace">android:</span>gravity</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>center<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name"><span class="token namespace">android:</span>hint</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>输入用户名<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>EditText</span>
        <span class="token attr-name"><span class="token namespace">android:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@+id/tv_pwd<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>match_parent<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>40dp<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name"><span class="token namespace">android:</span>layout_gravity</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>center<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name"><span class="token namespace">android:</span>layout_marginLeft</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>16dp<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name"><span class="token namespace">android:</span>layout_marginRight</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>16dp<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name"><span class="token namespace">android:</span>gravity</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>center<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name"><span class="token namespace">android:</span>hint</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>输入密码<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Button</span>
        <span class="token attr-name"><span class="token namespace">android:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@+id/btn_login<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>match_parent<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>40dp<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name"><span class="token namespace">android:</span>layout_gravity</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>center<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name"><span class="token namespace">android:</span>layout_marginLeft</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>16dp<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name"><span class="token namespace">android:</span>layout_marginRight</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>16dp<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name"><span class="token namespace">android:</span>gravity</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>center<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name"><span class="token namespace">android:</span>text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>登录<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>


<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>LinearLayout</span><span class="token punctuation">&gt;</span></span>

</code></pre></div><p><strong>Activity代码</strong></p> <div class="language- extra-class"><pre class="language-text"><code>
public class MVCActivity extends AppCompatActivity {

    TextView tvResult;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_login);
         tvResult = findViewById(R.id.tv_result);
        TextView tvAccount = findViewById(R.id.tv_account);
        TextView tvPwd = findViewById(R.id.tv_pwd);
        Button btnLogin = findViewById(R.id.btn_login);

        MVCController mvcController = new MVCController();

        btnLogin.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                mvcController.login(tvAccount.getText().toString(),tvPwd.getText().toString(), MVCActivity.this);
            }
        });
    }


    public void loginSuccess(){
        tvResult.setText(&quot;登录结果：登录成功&quot;);
    }

    public void loginFail(){
        tvResult.setText(&quot;登录结果：登录失败&quot;);
    }

}

</code></pre></div><p><strong>Controller代码</strong></p> <div class="language- extra-class"><pre class="language-text"><code>public class MVCController {

    MVCModel mvcModel;

    public MVCController() {
        mvcModel = new MVCModel();
    }

    public void login(String account, String pwd, MVCActivity loginActivity) {
        mvcModel.login(account, pwd, loginActivity);
    }
}

</code></pre></div><p><strong>Model代码</strong></p> <div class="language- extra-class"><pre class="language-text"><code>public class MVCModel {

    public void login(String account, String pwd, MVCActivity loginActivity){

        if (account == null || account.length()==0) {
            loginActivity.loginFail();
        }

        if (pwd == null || pwd.length()==0) {
            loginActivity.loginFail();
        }


        if (&quot;user123&quot;.equals(account) &amp;&amp; &quot;pwd123&quot;.equals(pwd)){
            loginActivity.loginSuccess();
        }

    }

}
</code></pre></div><h3 id="实现代码说明"><a href="#实现代码说明" class="header-anchor">#</a> 实现代码说明</h3> <p>在Activity中监听登录按钮的事件，接收到事件之后，调用Controller的登录方法处理登录逻辑，在Controller的登录方法中调用Model请求网络数据（这里是模拟）判断是否登录成功，Model拿到登录结果后，调用Activity的方法刷新页面数据，展示登录结果。</p> <h3 id="优缺点"><a href="#优缺点" class="header-anchor">#</a> 优缺点</h3> <p>优点：通过划分模块的方式，将系统分成了3个模块，视图层，业务层和数据层。 代码开发实现不再是只在一个代码文件中，一定程度便于程序开发。</p> <p>缺点：但是三个模块之间还存在很强的耦合关系。 不利于业务需求的更变和代码维护工作。</p> <h2 id="mvp"><a href="#mvp" class="header-anchor">#</a> MVP</h2> <p><img src="https://gitee.com/yutian_9065/img/raw/master/img/202302061539762.png" alt="image-20230206153920702"></p> <p>MVP架构是基于MVC的改进，将MVC的中Controller独立出来作为Presenter。 xml和Activity还是作为视图层， 视图层接收到页面数据，调用Presenter进行业务逻辑处理，Presenter调用Model进行数据处理，Model回传数据给Presenter，Presenter回传数据给View。数据的回传通过接口回调的方式来实现。</p> <p><strong>代码结构</strong></p> <p><img src="https://gitee.com/yutian_9065/img/raw/master/img/202302061544339.png" alt="image-20230206154424284"></p> <p><strong>IModel接口代码</strong></p> <div class="language- extra-class"><pre class="language-text"><code>public interface IModel {
    public boolean login(String account, String pwd);
}

</code></pre></div><p><strong>IView接口代码</strong></p> <div class="language- extra-class"><pre class="language-text"><code>public interface IView {
    public void loginSuccess();
    public void loginFail();
}

</code></pre></div><p><strong>Activity代码</strong></p> <div class="language- extra-class"><pre class="language-text"><code>public class MVPActivity extends AppCompatActivity implements IView {

    TextView tvResult;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_login);

        tvResult = findViewById(R.id.tv_result);

        TextView tvAccount = findViewById(R.id.tv_account);
        TextView tvPwd = findViewById(R.id.tv_pwd);
        Button btnLogin = findViewById(R.id.btn_login);

        MVPPresenter presenter = new MVPPresenter();
        presenter.setiView(this);
        btnLogin.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                presenter.login(tvAccount.getText().toString(), tvPwd.getText().toString());
            }
        });
    }

    public void loginSuccess() {
        tvResult.setText(&quot;登录结果：登录成功&quot;);
    }

    public void loginFail() {
        tvResult.setText(&quot;登录结果：登录失败&quot;);
    }
}
</code></pre></div><p><strong>Model代码</strong></p> <div class="language- extra-class"><pre class="language-text"><code>public class MVPModel implements IModel {
    public boolean login(String account, String pwd) {

        if (account == null || account.length() == 0) {
            return false;
        }

        if (pwd == null || pwd.length() == 0) {
            return false;
        }


        if (&quot;user123&quot;.equals(account) &amp;&amp; &quot;pwd123&quot;.equals(pwd)) {
            return true;

        }
        return false;
    }
}
</code></pre></div><p><strong>Presenter代码</strong></p> <div class="language- extra-class"><pre class="language-text"><code>public class MVPPresenter {

    MVPModel model;

    public MVPPresenter() {
        model = new MVPModel();
    }

    IView iView;

    public void setiView(IView iView) {
        this.iView = iView;
    }

    public void login(String account, String pwd) {
        boolean loginResult = model.login(account, pwd);

        if (loginResult){
            iView.loginSuccess();
        }else {
            iView.loginFail();
        }
    }
}
</code></pre></div><h3 id="实现代码说明-2"><a href="#实现代码说明-2" class="header-anchor">#</a> 实现代码说明</h3> <p>定义了两个接口，IView和IModel, Activity和Model分别实现了这两个接口。 在Presenter中持有这两个实例。Presenter调用Model处理数据后，通过Iview的接口方法回调给Activity刷新页面。</p> <h3 id="优缺点-2"><a href="#优缺点-2" class="header-anchor">#</a> 优缺点</h3> <p>从上面的代码可以看到，三个模块之间的通信是通过接口实现的，在实际开发，定义的接口和方法会非常多。 导致很简单的一个页面功能也需要实现多个接口和方法。</p> <p>优点就是通过Presenter，把MVC中的Controller代码抽出来了，并且Presenter作为View和Model通信的桥梁，完成了Model和View的解耦。</p> <h2 id="mvvm"><a href="#mvvm" class="header-anchor">#</a> MVVM</h2> <p><img src="https://gitee.com/yutian_9065/img/raw/master/img/202302071024407.png" alt="image-20230207102411342"></p> <p>MVVM在MVP的基础上加入了双向绑定，使View能够感知ViewModel中的数据变化，ViewModel能够感知View数据的变化。</p> <p><strong>代码结构</strong></p> <p><img src="https://gitee.com/yutian_9065/img/raw/master/img/202302071029825.png" alt="image-20230207102912754"></p> <p><strong>xml代码</strong></p> <div class="language- extra-class"><pre class="language-text"><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;layout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;

    &lt;data&gt;

        &lt;variable
            name=&quot;viewModel&quot;
            type=&quot;com.domain.android.study.notes.architecture.mvvm.MVVMViewModel&quot; /&gt;

    &lt;/data&gt;

    &lt;LinearLayout
        xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
        android:id=&quot;@+id/ll_gallery_outer&quot;
        android:layout_width=&quot;match_parent&quot;
        android:layout_height=&quot;match_parent&quot;
        android:orientation=&quot;vertical&quot;&gt;

        &lt;TextView
            android:id=&quot;@+id/tv_result&quot;
            android:layout_width=&quot;wrap_content&quot;
            android:layout_height=&quot;wrap_content&quot;
            android:text=&quot;@{viewModel.result}&quot;
            android:layout_gravity=&quot;center&quot; /&gt;

        &lt;EditText
            android:id=&quot;@+id/tv_account&quot;
            android:layout_width=&quot;match_parent&quot;
            android:layout_marginLeft=&quot;16dp&quot;
            android:layout_marginRight=&quot;16dp&quot;
            android:layout_height=&quot;40dp&quot;
            android:hint=&quot;输入用户名&quot;
            android:gravity=&quot;center&quot;
            android:text=&quot;@={viewModel.account}&quot;

            android:layout_gravity=&quot;center&quot;
            android:layout_marginTop=&quot;20dp&quot; /&gt;

        &lt;EditText
            android:id=&quot;@+id/tv_pwd&quot;
            android:layout_width=&quot;match_parent&quot;
            android:layout_marginLeft=&quot;16dp&quot;
            android:layout_marginRight=&quot;16dp&quot;
            android:layout_height=&quot;40dp&quot;
            android:hint=&quot;输入密码&quot;
            android:text=&quot;@={viewModel.pwd}&quot;
            android:gravity=&quot;center&quot;
            android:layout_gravity=&quot;center&quot; /&gt;

        &lt;Button
            android:id=&quot;@+id/btn_login&quot;
            android:layout_width=&quot;match_parent&quot;
            android:layout_marginLeft=&quot;16dp&quot;
            android:layout_marginRight=&quot;16dp&quot;
            android:layout_height=&quot;40dp&quot;
            android:text=&quot;登录&quot;
            android:gravity=&quot;center&quot;
            android:layout_gravity=&quot;center&quot; /&gt;


    &lt;/LinearLayout&gt;
&lt;/layout&gt;
</code></pre></div><p><strong>Activity代码</strong></p> <div class="language- extra-class"><pre class="language-text"><code>public class MVVMActivity extends AppCompatActivity {

    MVVMViewModel viewModel;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        ActivityLoginBinding binding = DataBindingUtil.setContentView(this, R.layout.activity_login);
        viewModel = ViewModelProviders.of(this).get(MVVMViewModel.class);
        binding.setVariable(BR.viewModel, viewModel);
        binding.setLifecycleOwner(this);
        binding.btnLogin.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                viewModel.login();
            }
        });

    }

}
</code></pre></div><p><strong>ViewModel代码</strong></p> <div class="language- extra-class"><pre class="language-text"><code>public class MVVMViewModel  extends ViewModel {

    public ObservableField&lt;String&gt; account = new ObservableField&lt;&gt;(&quot;&quot;);
    public ObservableField&lt;String&gt; pwd = new ObservableField&lt;&gt;(&quot;&quot;);
    public ObservableField&lt;String&gt; result = new ObservableField&lt;&gt;(&quot;&quot;);

    MVVMModel mvvmModel;
    public MVVMViewModel() {
         mvvmModel = new MVVMModel();
    }

    public void login(){
        boolean loginResult = mvvmModel.login(account.get(), pwd.get());
        result.set(loginResult ? &quot;登录结果：成功&quot; :&quot;登录结果：失败&quot;);
    }

}
</code></pre></div><p><strong>Model代码</strong></p> <div class="language- extra-class"><pre class="language-text"><code>public class MVVMModel {
    public boolean login(String account, String pwd) {
        if (account == null || account.length() == 0) {
            return false;
        }

        if (pwd == null || pwd.length() == 0) {
            return false;
        }
        if (&quot;user123&quot;.equals(account) &amp;&amp; &quot;pwd123&quot;.equals(pwd)) {
            return true;
        }
        return false;
    }
}
</code></pre></div><p><strong>注意</strong></p> <p>在本例MVVM架构实现中，用到了Android提供的data binding这个数据双向绑定框架。需要在APP模块的gralde文件中添加以下配置开启：</p> <div class="language- extra-class"><pre class="language-text"><code> android {
 ...
 dataBinding {
        enabled true
    }
  ...
    }
</code></pre></div><h3 id="实现代码说明-3"><a href="#实现代码说明-3" class="header-anchor">#</a> 实现代码说明</h3> <p>通过Android提供的数据双向绑定库data binding 将Acitvity/xml视图层与ViewModel绑定。在xml布局文件中，通过<code>@{}</code>来表示单向绑定或者<code>@={}</code>来表示双向绑定。Activity接受到视图层的登录点击事件后，调用ViewModel处理登录业务逻辑，ViewModel通过双向数据绑定拿到到视图层输入的账号密码数据，调用Model处理数据，Model处理数据后，回传给ViewModel, ViewModel的数据改变，View感知后刷新页面。</p> <p><strong>注意</strong></p> <p>data binding通过观察者模式实现。 内部具体实现也是通过调用notify通知数据变化给观察者，notify调用了观察者实现的接口方法。</p> <h3 id="优缺点-3"><a href="#优缺点-3" class="header-anchor">#</a> 优缺点</h3> <p>优点：经过数据双向绑定之后，我们不在需要想MVP中写那么多接口回调方法区实现视图层和业务层的交互。业务层也不再持有视图层的引用。</p> <p>缺点：通过这种方式进行数据双向绑定后，xml中会多出一些标签、表达式、甚至和业务有点的简单计算代码。这不利于业务的逻辑的查看。并且由于双向绑定是data binding实现的。在这个过程中， 如果出现bug导致数据没有被感知改变，不方便排错，因为xml不能debug调试。</p> <h1 id="_03-总结"><a href="#_03-总结" class="header-anchor">#</a> 03 总结</h1> <p>MVC、MVP、MVVM大体上都是把系统划分成3个模块：视图层、业务层、数据层。 但是他们的通信方式、数据流动方向不一致，形成了不同的架构。 其后面产生的架构都是为了更好的解耦，解决已有架构的不足。每个架构都有自己的优缺点，<strong>没有最好的架构，只有最合适的架构。</strong></p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">1/9/2024, 11:22:13 AM</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.75a2606c.js" defer></script><script src="/assets/js/3.7b5fc60a.js" defer></script><script src="/assets/js/1.84786563.js" defer></script><script src="/assets/js/68.fbf4d68c.js" defer></script>
  </body>
</html>
